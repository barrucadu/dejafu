# Set-up
sudo: false

language: c

# If something is tagged, it's come from a PR which has been merged
# into master.  There's no need to build both the tag and the merge
# commit.
if: tag IS blank

addons:
  apt:
    packages:
    - libgmp-dev

env:
  global:
  - secure: "J8fH1I5Etz1TpB8aZwtbFGp4GDgq5NCevVkthAAPLMMNRM+WYG5hznEq4GnvY0sWyBYhVuEapq31w+Mjx1PjiMaVeipdcd9+fOo/K//jg0BU8Jj9MpFHzHmmiE0HB35Dm8lro7QBPIgX0e59qbK7MScZ4JZTBqL3OS1y3mtxdks="

script: ./.travis/$MODE

jobs:
  include:
  - stage: predeploy
    if: branch=master
    env: MODE=predeploy

  - stage: deploy
    if: branch=master AND type != pull_request
    env: MODE=deploy
